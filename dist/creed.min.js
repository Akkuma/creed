!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.creed={})}(this,function(t){"use strict";function n(t){return function(){return setTimeout(t,0)}}function e(t){return function(){return process.nextTick(t)}}function r(t){var n=document.createTextNode("");new wt(t).observe(n,{characterData:!0});var e=0;return function(){return n.data=e^=1}}function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t){return(t.state()&bt)>0}function c(t){return(t.state()&At)>0}function u(t){return(t.state()&jt)>0}function s(t){return(t.state()&kt)>0}function f(t){return(t.state()&Tt)>0}function a(t){return(t.state()&Et)>0}function p(t){c(t)||t._runAction(Pt)}function h(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function l(t,n){try{y(n,t)}finally{n.length=0}}function y(t,n){for(var e=0;e<t.length;++e){var r=t[e];a(r)||n(r)}}function d(){}function v(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function m(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function w(t,n,e,r){return e._when(new Mt(t,n,r)),r}function _(t,n,e){return"function"!=typeof t?(e._become(n),!1):(g(t,n.value,e),!0)}function g(t,n,e){try{e._resolve(t(n))}catch(r){e._reject(r)}}function b(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function A(t,n,e){return n._runAction(new Kt(t,e)),e}function j(t,n){n._become(t)}function k(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function T(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(t.__proto__=n)}function E(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function P(t){i(t)&&t._reject(new Nt("promise timeout"))}function C(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function x(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function S(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function R(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function O(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function F(t){return Array.isArray(t)?new Array(t.length):[]}function M(t,n,e,r){var o=Array.isArray(e)?H:K;return o(t,n,e,r).near()}function H(t,n,e,r){for(var o=0;o<e.length;++o)N(t,n,e[o],o,r);return n.complete(o,r),r}function K(t,n,e,r){var o=0,i=!0,c=!1,u=void 0;try{for(var s,f=e[Symbol.iterator]();!(i=(s=f.next()).done);i=!0){var a=s.value;N(t,n,a,o++,r)}}catch(p){c=!0,u=p}finally{try{!i&&f["return"]&&f["return"]()}finally{if(c)throw u}}return n.complete(o,r),r}function N(t,n,e,r,o){if(v(e)){var i=t(e);o._isResolved()?p(i):c(i)?n.fulfillAt(i,r,o):u(i)?n.rejectAt(i,r,o):i._runAction(new It(n,r,o))}else n.valueAt(e,r,o)}function W(t,n,e,r){function o(t){r._resolve(t)}function i(t){r._reject(t)}switch(e.length){case 0:t.call(n,o,i);break;case 1:t.call(n,e[0],o,i);break;case 2:t.call(n,e[0],e[1],o,i);break;case 3:t.call(n,e[0],e[1],e[2],o,i);break;default:e.push(o,i),t.apply(n,e)}return r}function D(t,n,e,r){function o(t,n){t?r._reject(t):r._fulfill(n)}switch(e.length){case 0:t.call(n,o);break;case 1:t.call(n,e[0],o);break;case 2:t.call(n,e[0],e[1],o);break;case 3:t.call(n,e[0],e[1],e[2],o);break;default:e.push(o),t.apply(n,e)}return r}function q(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function z(t,n,e,r,o){try{B(t,n.call(r,e),r,o)}catch(i){o._reject(i)}}function B(t,n,e,r){return n.done?r._resolve(n.value):void t(n.value)._runAction(new Lt(t,e,r))}function G(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(t.__proto__=n)}function I(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function J(t){return at(t)?t.near():v(t)?ht(t):new Yt(t)}function L(t){return new Zt(t)}function Q(){return new $t}function U(t){for(var n=arguments.length,e=Array(n>1?n-1:0),r=1;n>r;r++)e[r-1]=arguments[r];return V(t,this,e,new Xt)}function V(t,n,e,r){dt(t);try{W(t,n,e,r)}catch(o){r._reject(o)}return r}function X(t,n){var e=J(n);return 0>=t||u(e)||f(e)?e:Ht(t,e,new Xt)}function Y(t,n){var e=J(n);return s(e)?e:Wt(t,e,new Xt)}function Z(t){var n=new Bt(tn,F(t));return rt(n,t)}function $(t){return rt(new zt(Q),t)}function tt(t){return rt(new qt,t)}function nt(t){var n=new Gt(J,F(t));return rt(n,t)}function et(t){return"object"==typeof t&&null!==t}function rt(t,n){if(!et(n))return L(new TypeError("expected an iterable"));var e=new Xt;return M(pt,t,n,e)}function ot(t){for(var n=arguments.length,e=Array(n>1?n-1:0),r=1;n>r;r++)e[r-1]=arguments[r];return it(t,this,e)}function it(t,n,e){var r=new Bt(new nn(t,n),F(e));return rt(r,e)}function ct(t){return function(){for(var n=arguments.length,e=Array(n),r=0;n>r;r++)e[r]=arguments[r];return ut(t,this,e,new Xt)}}function ut(t,n,e,r){dt(t);try{D(t,n,e,r)}catch(o){r._reject(o)}return r}function st(t){return function(){for(var n=arguments.length,e=Array(n),r=0;n>r;r++)e[r]=arguments[r];return ft(t,this,e)}}function ft(t,n,e){var r=t.apply(n,e);return Jt(J,r,new Xt)}function at(t){return null!==t&&"object"==typeof t&&t._isPromise===Vt}function pt(t){return at(t)?t.near():ht(t)}function ht(t){try{var n=t.then;return"function"==typeof n?lt(n,t,new Xt):new Yt(t)}catch(e){return new Zt(e)}}function lt(t,n,e){try{t.call(n,function(t){return e._resolve(t)},function(t){return e._reject(t)})}catch(r){e._reject(r)}return e}function yt(){return new Zt(new TypeError("resolution cycle"))}function dt(t){if("function"!=typeof t)throw new TypeError("must provide a resolver function")}function vt(){var t="function"==typeof Promise&&Promise;return"undefined"!=typeof self?self.Promise=on:"undefined"!=typeof global&&(global.Promise=on),t}var mt="undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process),wt="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver,_t=function(t){return mt?e(t):wt?r(t):n(t)},gt=function(){function t(){var n=this;o(this,t),this.tasks=new Array(65536),this.length=0,this.drain=_t(function(){return n._drain()})}return t.prototype.add=function(t){0===this.length&&this.drain(),this.tasks[this.length++]=t},t.prototype._drain=function(){for(var t=this.tasks,n=0;n<this.length;++n)t[n].run(),t[n]=void 0;this.length=0},t}(),bt=1,At=2,jt=4,kt=At|jt,Tt=8,Et=16,Pt={fulfilled:function(){},rejected:function(t){t._state|=Et}};t.isFulfilled=c,t.isRejected=u,t.isSettled=s,t.isPending=i,t.isNever=f;var Ct="unhandledRejection",xt="rejectionHandled",St=function(){function t(n,e){h(this,t),this.errors=[],this.emit=n,this.reportError=e}return t.prototype.track=function(t){this.emit(Ct,t,t.value)||(0===this.errors.length&&setTimeout(l,1,this.reportError,this.errors),this.errors.push(t))},t.prototype.untrack=function(t){p(t),this.emit(xt,t)},t}(),Rt="unhandledRejection",Ot=function(){return mt&&"function"==typeof process.emit?function(t,n){return t===Rt?process.emit(t,n.value,n):process.emit(t,n)}:"undefined"!=typeof self&&"function"==typeof CustomEvent?function(t,n,e){var r=!1;try{r=new e(Rt)instanceof e}catch(o){}return r?function(t,r){var o=new e(t,{detail:{reason:r.value,promise:r},bubbles:!1,cancelable:!0});return!n.dispatchEvent(o)}:t}(d,self,CustomEvent):d},Ft=w,Mt=function(){function t(n,e,r){m(this,t),this.f=n,this.r=e,this.promise=r}return t.prototype.fulfilled=function(t){_(this.f,t,this.promise)},t.prototype.rejected=function(t){return _(this.r,t,this.promise)},t}(),Ht=A,Kt=function(){function t(n,e){b(this,t),this.time=n,this.promise=e}return t.prototype.fulfilled=function(t){setTimeout(j,this.time,t,this.promise)},t.prototype.rejected=function(t){return this.promise._become(t),!1},t}(),Nt=function(t){function n(e){k(this,n),t.call(this),this.message=e,this.name=n.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}return T(n,t),n}(Error),Wt=function(t,n,e){var r=setTimeout(P,t,e);return n._runAction(new Dt(r,e)),e},Dt=function(){function t(n,e){E(this,t),this.timer=n,this.promise=e}return t.prototype.fulfilled=function(t){clearTimeout(this.timer),this.promise._become(t)},t.prototype.rejected=function(t){return clearTimeout(this.timer),this.promise._become(t),!1},t}(),qt=function(){function t(){C(this,t),this.done=!1,this.pending=0}return t.prototype.valueAt=function(t,n,e){e._fulfill(t)},t.prototype.fulfillAt=function(t,n,e){e._become(t)},t.prototype.rejectAt=function(t,n,e){p(t),this.check(this.pending-1,e)},t.prototype.complete=function(t,n){this.done=!0,this.check(this.pending+t,n)},t.prototype.check=function(t,n){this.pending=t,this.done&&0===t&&n._reject(new Error)},t}(),zt=function(){function t(n){x(this,t),this.never=n}return t.prototype.valueAt=function(t,n,e){e._fulfill(t)},t.prototype.fulfillAt=function(t,n,e){e._become(t)},t.prototype.rejectAt=function(t,n,e){e._become(t)},t.prototype.complete=function(t,n){0===t&&n._become(this.never())},t}(),Bt=function(){function t(n,e){S(this,t),this.done=!1,this.pending=0,this.results=e,this.mergeHandler=n}return t.prototype.valueAt=function(t,n,e){this.results[n]=t,this.check(this.pending-1,e)},t.prototype.fulfillAt=function(t,n,e){this.valueAt(t.value,n,e)},t.prototype.rejectAt=function(t,n,e){e._become(t)},t.prototype.complete=function(t,n){this.done=!0,this.check(this.pending+t,n)},t.prototype.check=function(t,n){this.pending=t,this.done&&0===t&&this.mergeHandler.merge(n,this.results)},t}(),Gt=function(){function t(n,e){R(this,t),this.done=!1,this.pending=0,this.results=e,this.resolve=n}return t.prototype.valueAt=function(t,n,e){this.settleAt(this.resolve(t),n,e)},t.prototype.fulfillAt=function(t,n,e){this.settleAt(t,n,e)},t.prototype.rejectAt=function(t,n,e){p(t),this.settleAt(t,n,e)},t.prototype.settleAt=function(t,n,e){this.results[n]=t,this.check(this.pending-1,e)},t.prototype.complete=function(t,n){this.done=!0,this.check(this.pending+t,n)},t.prototype.check=function(t,n){this.pending=t,this.done&&0===t&&n._fulfill(this.results)},t}(),It=function(){function t(n,e,r){O(this,t),this.handler=n,this.index=e,this.promise=r}return t.prototype.fulfilled=function(t){this.handler.fulfillAt(t,this.index,this.promise)},t.prototype.rejected=function(t){return this.handler.rejectAt(t,this.index,this.promise)},t}(),Jt=function(t,n,e){return z(t,n.next,void 0,n,e),e},Lt=function(){function t(n,e,r){q(this,t),this.refFor=n,this.iterator=e,this.promise=r}return t.prototype.fulfilled=function(t){var n=this.iterator;z(this.refFor,n.next,t.value,n,this.promise)},t.prototype.rejected=function(t){var n=this.iterator;return z(this.refFor,n["throw"],t.value,n,this.promise),!0},t}(),Qt=new gt,Ut=new St(Ot(),function(t){throw t.value}),Vt={},Xt=function(){function t(){I(this,t),this.ref=void 0,this.action=void 0,this.length=0}return t.prototype.then=function(n,e){var r=this.near();return s(r)?r.then(n,e):Ft(n,e,r,new t)},t.prototype["catch"]=function(t){return this.then(void 0,t)},t.prototype.toString=function(){return"[object "+this.inspect()+"]"},t.prototype.inspect=function(){var t=this.near();return s(t)?t.inspect():"Promise { pending }"},t.prototype.near=function(){if(!this._isResolved())return this;for(var t=this;void 0!==t.ref;)if(t=t.ref,t===this){t=yt();break}return this.ref=t},t.prototype.state=function(){return this._isResolved()?this.ref.near().state():bt},t.prototype._isResolved=function(){return void 0!==this.ref},t.prototype._when=function(t){this._runAction(t)},t.prototype._runAction=function(t){void 0===this.action?(this.action=t,this._isResolved()&&Qt.add(this)):this[this.length++]=t},t.prototype._resolve=function(t){this._become(J(t))},t.prototype._fulfill=function(t){this._become(new Yt(t))},t.prototype._reject=function(t){this._isResolved()||this.__become(new Zt(t))},t.prototype._become=function(t){this._isResolved()||this.__become(t)},t.prototype.__become=function(t){this.ref=t,void 0!==this.action&&Qt.add(this)},t.prototype.run=function(){var t=this.ref.near();t._runAction(this.action),this.action=void 0;for(var n=0;n<this.length;++n)t._runAction(this[n]),this[n]=void 0;this.length=0},t}();Xt.prototype._isPromise=Vt;var Yt=function(){function t(n){I(this,t),this.value=n}return t.prototype.then=function(t){return Ft(t,void 0,this,new Xt)},t.prototype["catch"]=function(){return this},t.prototype.toString=function(){return"[object "+this.inspect()+"]"},t.prototype.inspect=function(){return"Promise { fulfilled: "+this.value+" }"},t.prototype.state=function(){return At},t.prototype.near=function(){return this},t.prototype._when=function(t){Qt.add(new en(t,this))},t.prototype._runAction=function(t){t.fulfilled(this)},t}();Yt.prototype._isPromise=Vt;var Zt=function(){function t(n){I(this,t),this.value=n,this._state=jt,Ut.track(this)}return t.prototype.then=function(t,n){return"function"==typeof n?this["catch"](n):this},t.prototype["catch"]=function(t){return Ft(void 0,t,this,new Xt)},t.prototype.toString=function(){return"[object "+this.inspect()+"]"},t.prototype.inspect=function(){return"Promise { rejected: "+this.value+" }"},t.prototype.state=function(){return this._state},t.prototype.near=function(){return this},t.prototype._when=function(t){Qt.add(new en(t,this))},t.prototype._runAction=function(t){t.rejected(this)&&Ut.untrack(this)},t}();Zt.prototype._isPromise=Vt;var $t=function(){function t(){I(this,t)}return t.prototype.then=function(){return this},t.prototype["catch"]=function(){return this},t.prototype.toString=function(){return"[object "+this.inspect()+"]"},t.prototype.inspect=function(){return"Promise { never }"},t.prototype.state=function(){return bt|Tt},t.prototype.near=function(){return this},t.prototype._when=function(){},t.prototype._runAction=function(){},t}();$t.prototype._isPromise=Vt;var tn={merge:function(t,n){t._fulfill(n)}},nn=function(){function t(n,e){I(this,t),this.f=n,this.c=e,this.promise=void 0,this.args=void 0}return t.prototype.merge=function(t,n){this.promise=t,this.args=n,Qt.add(this)},t.prototype.run=function(){try{this.promise._resolve(this.f.apply(this.c,this.args))}catch(t){this.promise._reject(t)}},t}(),en=function(){function t(n,e){I(this,t),this.action=n,this.ref=e}return t.prototype.run=function(){this.ref._runAction(this.action)},t}(),rn=[],on=function(t){function n(e){I(this,n),t.call(this),V(e,void 0,rn,this)}return G(n,t),n}(Xt);on.resolve=J,on.reject=L,on.all=Z,on.race=$,"function"!=typeof Promise&&vt(),t.resolve=J,t.reject=L,t.never=Q,t.promise=U,t.delay=X,t.timeout=Y,t.all=Z,t.race=$,t.any=tt,t.settle=nt,t.merge=ot,t.node=ct,t.co=st,t.shim=vt,t.Future=Xt,t.Promise=on});